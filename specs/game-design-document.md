# Game Design Document: Hexagon Strategy (v1.2 — Enhanced Edition)

## 1. Overview
Покрокова стратегічна гра у браузері на гексагональній карті. Гравець змагається з ШІ за контроль над усіма територіями. Натхнення — Risk та Civilization.  
**Платформа:** Web Browser (HTML5 Canvas, no frameworks).  
**Версія:** 1.2 Enhanced Edition.

---

## 2. Карта

- **Форма:** Гексагональна сітка з радіусом 3 (осьові координати), генерується автоматично.
- **Кількість гексів:** 37 (фіксовано при radius=3).
- **Стартове розташування:** Гравець — крайній лівий гекс; ШІ — крайній правий; решта — нейтральні.
- **Одиниці на нейтральних:** 2–4 випадково.
- **Стартові одиниці (гравець/ШІ):** 5.

---

## 3. Фази ходу

### Підкріплення (`reinforce`)
- Кількість нових військ: `max(3, floor(owned_territories / 3))`.
- Гравець кліком розподіляє одиниці по своїх гексах (1 клік = +1 одиниця).
- Коли всі підкріплення витрачені — автоматичний перехід до фази атаки.

### Атака / Переміщення (`attack`)
- **Атака:** Вибрати свій гекс (>1 одиниці) → клік на сусідній ворожий.
  - Бойова механіка: кидок d6 за кожну сторону. Атакуючий перемагає при `атак > захист`.
  - При перемозі: переможений гекс переходить до атакуючого; атакуючий залишає 1 одиницю на старому місці.
  - При поразці: атакуючий втрачає 1 одиницю.
- **Переміщення:** Вибрати свій гекс → клік на сусідній свій → з'являється слайдер для вибору кількості (1 до units-1).
- Гравець може виконувати необмежену кількість атак / переміщень за хід.

### Кінець ходу
- Гравець натискає «Завершити хід» → хід передається ШІ → після дій ШІ знову хід гравця.

---

## 4. Умови завершення
- **Перемога:** Гравець захоплює ВСІ 37 гексів.
- **Поразка:** ШІ захоплює ВСІ гекси або гравець залишається без територій.
- Після завершення — екран з детальною статистикою.

---

## 5. ШІ — Human-Like AI

### Рівні складності
| Параметр | Легко | Нормально | Важко | Експерт |
|----------|-------|-----------|-------|---------|
| Агресія | 0.2 | 0.4 | 0.6 | 0.75 |
| Ризик | 0.1 | 0.35 | 0.5 | 0.65 |
| Фокус (точність) | 0.5 | 0.75 | 0.9 | 0.995 |
| Терплячість | Так | Рандом | Ні | Ні |
| Множник затримки | ×1.5 | ×1.0 | ×0.7 | ×0.3 |

### Стратегії ШІ
ШІ кожен хід обирає одну стратегію на основі балансу сил:
- **expand** — початок гри або багато нейтральних → пріоритет нейтральних гексів
- **defend** — ШІ слабший за гравця (<70% сили) → зміцнення кордонів
- **aggress** — ШІ сильніший (>130%) або висока агресія → атака гравця

### Пам'ять та "людськість"
- Запам'ятовує звідки гравець атакував останнього разу.
- Симулює «помилки» — іноді вибирає не найкращий варіант (залежно від `focusLevel`).
- Симулює «втому» — менше дій наприкінці ходу (тільки не на Expert).
- Варіативні паузи «розмірковування» (800±400мс на початку ходу, 400±300мс між діями).

---

## 6. Візуальний стиль

### Кольорова палітра
| Елемент | Колір |
|---------|-------|
| Фон | `#1a1c2c` |
| Гравець | `#00d2ff` (neon blue) |
| ШІ | `#ff416c` (crimson) |
| Нейтральний | `#95a5a6` (slate) |
| Вибір | `#f1c40f` (gold) |

### Ефекти
- **Частинки:** вибухи (30 частинок при атаці), сліди при переміщенні, конфетті (150 частинок) при перемозі.
- **Flash:** білий спалах на задіяному гексі (fade 0.05/кадр).
- **Пульсація:** вибраний гекс анімується через `sin(time*2)*2`.
- **Лінія атаки:** штрихована лінія + expandingring у кольорі атакуючого.

---

## 7. Статистика (відображається на екрані завершення)

Відстежується окремо для гравця та ШІ:
- Кількість атак / успішних атак / % успішності
- Кількість захоплених / втрачених територій
- Максимальна армія за гру
- Загальний час гри та кількість ходів
- Складність та розмір карти

---

## 8. Збереження стану
> ⚠️ Функція `localStorage` описана в старих специфікаціях, але **не реалізована** в поточній версії `game.js`. Стан не зберігається між сесіями.
